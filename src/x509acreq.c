/*
 * x509acreq.c
 *
 *  Created on: 15/01/2014
 *      Author: Giovani Milanez Espindola
 *  Contact: giovani.milanez@gmail.com
 */


#include "cryptobase/x509acreq.h"

ASN1_SEQUENCE(X509AC_ISSUE_INFO) =
{
	ASN1_OPT(X509AC_ISSUE_INFO, templateId, ASN1_INTEGER),
	ASN1_IMP(X509AC_ISSUE_INFO, holder, X509AC_HOLDER, 0),
	ASN1_IMP_OPT(X509AC_ISSUE_INFO, issuer, X509AC_ISSUER, 1),
	ASN1_IMP_OPT(X509AC_ISSUE_INFO, validity, X509AC_VAL, 2),
	ASN1_SEQUENCE_OF_OPT(X509AC_ISSUE_INFO, attributes, X509_ATTRIBUTE),
	ASN1_SEQUENCE_OF_OPT(X509AC_ISSUE_INFO, extensions, X509_EXTENSION)
} ASN1_SEQUENCE_END(X509AC_ISSUE_INFO)

ASN1_SEQUENCE(X509AC_SEARCH_INFO) =
{
	ASN1_IMP(X509AC_SEARCH_INFO, holder, X509AC_HOLDER, 0),
	ASN1_SEQUENCE_OF_OPT(X509AC_SEARCH_INFO, attributesOid, ASN1_OBJECT),
} ASN1_SEQUENCE_END(X509AC_SEARCH_INFO)

ASN1_SEQUENCE(X509AC_REV_INFO) =
{
	ASN1_IMP(X509AC_REV_INFO, holder, X509AC_HOLDER, 0),
	ASN1_SIMPLE(X509AC_REV_INFO, attributeOid, ASN1_OBJECT),
} ASN1_SEQUENCE_END(X509AC_REV_INFO)

ASN1_SEQUENCE(X509AC_REQ) =
{
	ASN1_SIMPLE(X509AC_REQ, version, ASN1_INTEGER),
	ASN1_SIMPLE(X509AC_REQ, reqType, ASN1_INTEGER),
	ASN1_IMP_OPT(X509AC_REQ, issueInfo, X509AC_ISSUE_INFO, 0),
	ASN1_IMP_OPT(X509AC_REQ, searchInfo, X509AC_SEARCH_INFO, 1),
	ASN1_IMP_OPT(X509AC_REQ, revInfo, X509AC_REV_INFO, 2)
} ASN1_SEQUENCE_END(X509AC_REQ)

IMPLEMENT_ASN1_FUNCTIONS(X509AC_SEARCH_INFO)
IMPLEMENT_ASN1_FUNCTIONS(X509AC_REV_INFO)
IMPLEMENT_ASN1_FUNCTIONS(X509AC_ISSUE_INFO)
IMPLEMENT_ASN1_FUNCTIONS(X509AC_REQ)

IMPLEMENT_ASN1_DUP_FUNCTION(X509AC_SEARCH_INFO)
IMPLEMENT_ASN1_DUP_FUNCTION(X509AC_REV_INFO)
IMPLEMENT_ASN1_DUP_FUNCTION(X509AC_ISSUE_INFO)
IMPLEMENT_ASN1_DUP_FUNCTION(X509AC_REQ)

IMPLEMENT_PEM_rw(X509AC_REQ, X509AC_REQ, PEM_STRING_ATTRIBUTE_CERTIFICATE_REQUEST, X509AC_REQ)
